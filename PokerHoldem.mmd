classDiagram
direction TB

%% =========================
%% GAME CONTROLLER
%% =========================

class GameController {
    +int MinPlayers$
    +int MaxPlayers$

    -GamePhase _phase
    -ChipStack _pot
    -int _currentBet
    -Table _table
    -int _dealerIndex
    -int _currentTurnIndex

    +Action~GamePhase~ OnPhaseChanged ~~
    +Action~Player,string~ OnPlayerAction ~~
    +Action~Player,HandRank~ OnHandEvaluated ~~

    +GameController()

    %% ===== GAME LIFECYCLE =====
    +InitializeGame() : void
    +StartGame() : void
    +StartRound() : void
    +EndRound() : void
    +ResetGame() : void
    +DetermineWinners() : List~Player~
    +DistributePot(List~Player~) : void

    %% ===== PHASE CONTROL =====
    +NextPhase() : void
    +SetPhase(GamePhase) : void
    +IsFinalPhase() : bool

    %% ===== TURN CONTROL =====
    +StartTurn() : void
    +EndTurn() : void
    +GetCurrentPlayer() : Player
    +MoveToNextPlayer() : void
    +IsBettingRoundComplete() : bool

    %% ===== BETTING =====
    +HandleBet(Player, ChipStack) : bool
    +HandleCall(Player) : bool
    +HandleRaise(Player, ChipStack) : bool
    +HandleCheck(Player) : bool
    +HandleFold(Player) : void
    +HandleAllIn(Player) : void

    %% ===== BET VALIDATION =====
    -ValidatePlayerTurn(Player) : bool
    -ValidateBetAmount(Player, ChipStack) : bool
    -UpdateCurrentBet(int) : void
    -CollectBet(Player, ChipStack) : void

    %% ===== DEALER RESPONSIBILITY (MERGED) =====
    -ShuffleDeck() : void
    -BurnCard() : void
    -DealHoleCards() : void
    -DealFlop() : void
    -DealTurn() : void
    -DealRiver() : void
}

%% =========================
%% TABLE
%% =========================

class Table {
    -List~Player~ _players
    -Deck _deck
    -List~Card~ _communityCards

    +int MinSeat$
    +int MaxSeat$

    +Table()
    +AddPlayer(Player) : bool
    +RemovePlayer(Player) : bool
    +GetActivePlayers() : List~Player~
    +ResetTable() : void
    +AddCommunityCard(Card) : void
    +ClearCommunityCards() : void
}

%% =========================
%% PLAYER
%% =========================

class Player {
    +int Id : readonly
    +string Name

    -ChipStack _chips
    -List~Card~ _hand
    -PlayerState _state

    +Action~ChipStack~ OnChipsChanged ~~
    +Action~Card~ OnCardReceived ~~

    +Player(int, string, ChipStack)

    %% ===== PLAYER ACTION =====
    +Bet(ChipStack) : void
    +Call() : void
    +Raise(ChipStack) : void
    +Check() : void
    +Fold() : void
    +AllIn() : void

    %% ===== CARD HANDLING =====
    +ReceiveCard(Card) : void
    +ClearHand() : void

    %% ===== STATE =====
    +SetState(PlayerState) : void
    +IsActive() : bool
    +HasChips() : bool
}

%% =========================
%% CHIP SYSTEM
%% =========================

class Chip {
    +int Value
}

class ChipStack {
    -List~Chip~ _chips

    +TotalValue() : int
    +AddChip(Chip) : void
    +AddStack(ChipStack) : void
    +RemoveValue(int) : ChipStack
    +IsEmpty() : bool
}

%% =========================
%% CARD SYSTEM
%% =========================

class Deck {
    -Stack~Card~ _cards

    +Initialize() : void
    +Shuffle() : void
    +Draw() : Card
    +RemainingCards() : int
}

class Card {
    +Suit Suit
    +Rank Rank
}

%% =========================
%% ENUMS
%% =========================

class GamePhase {
    <<enumeration>>
    PreFlop
    Flop
    Turn
    River
    Showdown
}

class PlayerState {
    <<enumeration>>
    Active
    Folded
    AllIn
    Eliminated
}

class Suit {
    <<enumeration>>
    Hearts
    Diamonds
    Clubs
    Spades
}

class Rank {
    <<enumeration>>
    Two
    Three
    Four
    Five
    Six
    Seven
    Eight
    Nine
    Ten
    Jack
    Queen
    King
    Ace
}

class HandRank {
    <<enumeration>>
    HighCard
    OnePair
    TwoPair
    ThreeOfAKind
    Straight
    Flush
    FullHouse
    FourOfAKind
    StraightFlush
    RoyalFlush
}

%% =========================
%% RELATIONSHIPS
%% =========================

GameController *-- Table
GameController *-- ChipStack : pot
GameController --> GamePhase
GameController --> HandRank

Table o-- Player
Table *-- Deck
Table o-- Card : communityCards

Player *-- ChipStack
Player o-- Card : hand
Player --> PlayerState

ChipStack *-- Chip
Deck *-- Card
Card --> Suit
Card --> Rank
